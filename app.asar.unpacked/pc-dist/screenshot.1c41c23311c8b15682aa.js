!function(t){function e(e){for(var n,l,r=e[0],h=e[1],c=e[2],d=0,u=[];d<r.length;d++)l=r[d],Object.prototype.hasOwnProperty.call(s,l)&&s[l]&&u.push(s[l][0]),s[l]=0;for(n in h)Object.prototype.hasOwnProperty.call(h,n)&&(t[n]=h[n]);for(a&&a(e);u.length;)u.shift()();return o.push.apply(o,c||[]),i()}function i(){for(var t,e=0;e<o.length;e++){for(var i=o[e],n=!0,r=1;r<i.length;r++){var h=i[r];0!==s[h]&&(n=!1)}n&&(o.splice(e--,1),t=l(l.s=i[0]))}return t}var n={},s={26:0},o=[];function l(e){if(n[e])return n[e].exports;var i=n[e]={i:e,l:!1,exports:{}};return t[e].call(i.exports,i,i.exports,l),i.l=!0,i.exports}l.m=t,l.c=n,l.d=function(t,e,i){l.o(t,e)||Object.defineProperty(t,e,{enumerable:!0,get:i})},l.r=function(t){"undefined"!=typeof Symbol&&Symbol.toStringTag&&Object.defineProperty(t,Symbol.toStringTag,{value:"Module"}),Object.defineProperty(t,"__esModule",{value:!0})},l.t=function(t,e){if(1&e&&(t=l(t)),8&e)return t;if(4&e&&"object"==typeof t&&t&&t.__esModule)return t;var i=Object.create(null);if(l.r(i),Object.defineProperty(i,"default",{enumerable:!0,value:t}),2&e&&"string"!=typeof t)for(var n in t)l.d(i,n,function(e){return t[e]}.bind(null,n));return i},l.n=function(t){var e=t&&t.__esModule?function(){return t.default}:function(){return t};return l.d(e,"a",e),e},l.o=function(t,e){return Object.prototype.hasOwnProperty.call(t,e)},l.p="";var r=this.webpackJsonp=this.webpackJsonp||[],h=r.push.bind(r);r.push=e,r=r.slice();for(var c=0;c<r.length;c++)e(r[c]);var a=h;o.push([1,13,12]),i()}({"/ey5":function(t,e,i){var n=i("3tO9");i("1rQ5");const s={},o=i("NLsH"),l=(o.desktopCapturer,o.ipcRenderer),r=o.webFrame,h=i("mw/K"),c="var(--B50)",a="PENCIL",d="HIGHLIGHT",u="TEXT";let p,y,f="",g=a,v=!1,x=null,w=null;class m{static isInsideRect(t,e,i){return!(t<i.x||e<i.y||t>i.x+i.width||e>i.y+i.height)}static reCalcXY(t,e,i,n,s){return t<s.x&&(t=s.x),e<s.y&&(e=s.y),t+i>s.x+s.width&&(t=s.x+s.width-i),e+n>s.y+s.height&&(e=s.y+s.height-n),[t,e]}static reCalcInRange(t,e,i){return Math.min(Math.max(t,e),i)}static isBetween(t,e,i){return(t.x-e.x)*(t.x-i.x)<=.01&&(t.y-e.y)*(t.y-i.y)<=.01}}class b{constructor(t,e){this.type=t;let i=0,n=0;switch(t){case"tl":case"bl":case"ml":i=e.x;break;case"tr":case"br":case"mr":i=e.x+e.width;break;case"mt":case"mb":i=e.x+e.width/2}i-=5,n=t.startsWith("t")||"mt"===t?e.y:t.startsWith("b")||"mb"===t?e.y+e.height:e.y+e.height/2,n-=5,this.coors={x:i,y:n,width:10,height:10};this.cursor={tl:"nw-resize",tr:"ne-resize",mt:"n-resize",mr:"e-resize",br:"se-resize",mb:"s-resize",bl:"sw-resize",ml:"w-resize"}[t]}getCursor(){return this.cursor}getDelta(t,e,i){let n=0,s=0;switch(this.type){case"tl":case"ml":case"bl":n=m.reCalcInRange(t-i.x,-i.x,i.width),s=-n;break;case"tr":case"br":case"mr":s=m.reCalcInRange(t-i.x-i.width,-i.width,w.width-i.x-i.width)}let o=0,l=0;switch(this.type){case"tl":case"mt":case"tr":o=m.reCalcInRange(e-i.y,-i.y,i.height),l=-o;break;case"bl":case"mb":case"br":l=m.reCalcInRange(e-i.y-i.height,-i.height,w.height-i.y-i.height)}return{dx:n,dy:o,dh:l,dw:s}}getCoors(){return this.coors}render(t){t.fillStyle=c,t.fillRect(this.coors.x,this.coors.y,this.coors.width,this.coors.height)}}class B{constructor(t){this.ele=t,this.ctx=t.getContext("2d"),this.objects=[],this.selection=null,this.history=[],this.undoList=[],this.isMouseDown=!1}_log(t){}_setSelection(t){this.prevSelection=this.selection,this.selection=t}getSelection(){return this.selection}_showTools(){this.selection&&(this.tools=function(t){let e=R(),i=0,n=0,s=e.clientWidth,o=e.clientHeight;n=t.y>window.innerHeight-o?t.y-o:t.y+t.height>window.innerHeight-o?t.y:t.y+t.height;i=t.x+t.width<s?t.x:t.x+t.width-s;e.style.visibility="visible",e.style.left=i+"px",e.style.top=n+"px";let l=D(),r=0,h=0,c=l.clientWidth,a=l.clientHeight;r=t.x+t.width>window.innerWidth-c?t.x>c?t.x-c:t.x:t.x+t.width;return l.style.left=r+"px",h=t.y,l.style.top=t.y+"px",l.style.visibility="visible",{save:{x:i,y:n,width:s,height:o},edit:{x:r,y:h,width:c,height:a}}}(this.selection))}_hideTools(){R().style.visibility="hidden",D().style.visibility="hidden",this.tools=null}_showControls(){if(this.selection){this._controls=[];let t=["tl","tr","bl","br","ml","mr","mt","mb"];for(let e=0;e<t.length;e++)this._controls.push(new b(t[e],this.selection))}}_hideControls(){this._controls=null}checkStyleBtn(t=!1){let e=document.getElementById("undoBtn"),i=document.getElementById("redoBtn");this.history.length<=0?e.className+="disableBtn":e.className=e.className.replace("disableBtn",""),t&&(this.undoList.length<=0?i.className+="disableBtn":i.className=i.className.replace("disableBtn",""))}undo(){if(!this.history||this.history.length<=0)return;let t=this.history.pop();this.undoList.push(t),this.checkStyleBtn(!0),document.getElementById("redoBtn").style.display="block",this.render()}redo(){if(!this.undoList||this.undoList.length<=0)return;let t=this.undoList.pop();this.history.push(t),this.checkStyleBtn(!0),this.render()}addText(t,e,i=0,n=0){if(e&&e.type===u&&e.value.length>0){t.textBaseline="top",t.textAlign="left",t.font=e.fontSize+"px "+e.font;let s=e.top-n;for(let n=0;n<e.value.length;n++)"<br>"!==e.value[n]&&(t.lineWidth=3,t.strokeStyle="white",t.strokeText(e.value[n],e.left-i,s),t.fillStyle=e.color,t.fillText(e.value[n],e.left-i,s)),s+=e.fontSize}}onSubmitText(t){let e=z(),i=e.innerHTML,n=parseInt(e.style.left),s=parseInt(e.style.top),o={value:i.replace(/<\/div>/g,"").split("<div>"),font:"serif",fontSize:25,color:"rgb(255,0,0)",left:n,top:s,type:u};this.addText(this.ctx,o),this.history.push(o),e.innerText="",e.style.visibility="hidden",this.checkStyleBtn(),this.isMouseDown=!1,t.stopPropagation(),t.preventDefault()}scalePath(t,e){let i=[];for(let s=0;s<t.length;s++){let o=t[s];switch(o.type){case a:case d:i.push(n(n({},o),{},{points:o.points.map((t=>({x:t.x*e,y:t.y*e})))}));break;default:i.push(o)}}return i}redraw(t,e=0,i=0,n=null){if(!this.history||this.history.length<=0)return;let s=this.history;null!==n&&(s=this.scalePath(s,n));for(let o=0;o<s.length;o++)switch(s[o].type){case a:case d:let n=s[o];this.drawLine(t,n,e,i);break;case u:this.addText(t,s[o],e,i)}}drawLine(t,e,i=0,n=0){if(e.points.length<2)return;let s=e.points[0],o=s;t.beginPath(),t.moveTo(s.x-i,s.y-n),t.lineWidth=e.width,t.strokeStyle=e.color,t.lineJoin="round",t.lineCap="round";let l=e.points.length;for(let r=1;r<l;r++){let s=e.points[r],l=m.isInsideRect(o.x,o.y,this.selection),h=m.isInsideRect(s.x,s.y,this.selection);if(h!==l){let e={};if(h){e=this.getIntersectionPoint(s,o);let l=this._refinePoint(e.x,e.y);t.moveTo(l.x-i,l.y-n);let r=this._refinePoint(s.x,s.y);t.lineTo(r.x-i,r.y-n)}else{e=this.getIntersectionPoint(o,s);let l=this._refinePoint(e.x,e.y);t.lineTo(l.x-i,l.y-n)}}else if(h&&l){let e=this._refinePoint(s.x,s.y);t.lineTo(e.x-i,e.y-n)}o=s}t.stroke()}getIntersectionPoint(t,e){let i={x:0,y:0},n=this.selection.x,s=this.selection.x+this.selection.width,o=this.selection.y,l=this.selection.y+this.selection.height;if(t.x-e.x==0)return i.x=t.x,i.y=o,m.isBetween(i,t,e)||(i.y=l),i;if(t.y-e.y==0)return i.y=t.y,i.x=n,m.isBetween(i,t,e)||(i.x=s),i;let r=(e.y-t.y)/(e.x-t.x),h=t.y-r*t.x;return i.x=n,i.y=r*i.x+h,m.isBetween(i,t,e)&&m.isInsideRect(i.x,i.y,this.selection)?i:(i.x=s,i.y=r*i.x+h,m.isBetween(i,t,e)&&m.isInsideRect(i.x,i.y,this.selection)?i:(i.y=o,i.x=(i.y-h)/r,m.isBetween(i,t,e)&&m.isInsideRect(i.x,i.y,this.selection)?i:(i.y=l,i.x=(i.y-h)/r,m.isBetween(i,t,e)&&m.isInsideRect(i.x,i.y,this.selection)?i:t)))}_refinePoint(t,e){let i={x:t,y:e},n=.01,s=this.selection.x,o=this.selection.x+this.selection.width,l=this.selection.y,r=this.selection.y+this.selection.height;return Math.abs(i.x-s)<n?i.x+=2:Math.abs(i.x-o)<n?i.x-=2:Math.abs(i.y-l)<n?i.y+=2:Math.abs(i.y-r)<n&&(i.y-=2),{x:Math.round(i.x),y:Math.round(i.y)}}onMouseMove(t){let e=m.reCalcInRange(t.pageX,0,w.width),i=m.reCalcInRange(t.pageY,0,w.height);if(this.start)return this._setSelection({x:Math.min(this.start.x,e),y:Math.min(this.start.y,i),width:Math.abs(this.start.x-e),height:Math.abs(this.start.y-i)}),this.render(),t.stopPropagation(),void t.preventDefault();if(this.startCtrl){let n=this.startCtrl.ctrl.getDelta(e,i,this.selection),s=this.selection.x+n.dx,o=this.selection.y+n.dy,l=this.selection.width+n.dw,r=this.selection.height+n.dh;return this._setSelection({x:s,y:o,width:l,height:r}),this._showControls(),this.render(),t.stopPropagation(),void t.preventDefault()}if(this.startMove){let n=e+this.startMove.dx,s=i+this.startMove.dy;return[n,s]=m.reCalcXY(n,s,this.selection.width,this.selection.height,w),this._setSelection({x:n,y:s,width:this.selection.width,height:this.selection.height}),this._showControls(),this.render(),t.stopPropagation(),void t.preventDefault()}if(this._controls)for(let n=0;n<this._controls.length;n++){let s=this._controls[n];if(m.isInsideRect(e,i,s.getCoors()))return this.ele.style.cursor=s.getCursor(),t.stopPropagation(),void t.preventDefault()}if(""===f&&this.selection&&m.isInsideRect(e,i,this.selection))this.ele.style.cursor="move";else if(this.ele.style.cursor="crosshair",this.isMouseDown&&this.selection)switch(f){case a:case d:let e=this.history.length-1;if(e>=0&&this.history[e].type===a){let i=this.history[e].points[this.history[e].points.length-1],n={x:t.pageX,y:t.pageY};this.history[e].points.push(n),this.ctx.moveTo(i.x,i.y);let s=m.isInsideRect(i.x,i.y,this.selection),o=m.isInsideRect(t.pageX,t.pageY,this.selection);if(o!==s){let t={};if(o){t=this.getIntersectionPoint(n,i);let e=this._refinePoint(t.x,t.y);this.ctx.moveTo(e.x,e.y);let s=this._refinePoint(n.x,n.y);this.ctx.lineTo(s.x,s.y)}else{t=this.getIntersectionPoint(i,n);let e=this._refinePoint(t.x,t.y);this.ctx.lineTo(e.x,e.y)}this.ctx.stroke()}else if(o){let t=this._refinePoint(n.x,n.y);this.ctx.lineTo(t.x,t.y),this.ctx.stroke()}}}}onMouseDown(t){if("which"in t?3===t.which:2===t.button)return f===u&&this.onSubmitText(t),f="",this.isMouseDown=!1,j(),t.stopPropagation(),void t.preventDefault();if(!(this.tools&&m.isInsideRect(t.pageX,t.pageY,this.tools.save)||this.tools&&m.isInsideRect(t.pageX,t.pageY,this.tools.edit))){if(""!==f){if(!m.isInsideRect(t.pageX,t.pageY,this.selection))return;switch(f){case a:case d:this.isMouseDown=!0;let e={points:[{x:t.pageX,y:t.pageY}],width:"4",color:f==d?"rgba(255,0,0,0.5)":"rgb(255,0,0)",type:a,compositeOpt:f==d?"xor":"source-over"};this.history.push(e),this.ctx.beginPath(),this.ctx.moveTo(t.pageX,t.pageY),this.ctx.strokeStyle=e.color,this.ctx.lineWidth=e.width,this.ctx.lineJoin="round",this.ctx.lineCap="round",this.ctx.globalCompositeOperation=e.compositeOpt;break;case u:let i=z();if("visible"===i.style.visibility&&""!==i.innerText)break;i.style.left=t.pageX+"px",i.style.top=t.pageY+"px",i.style.visibility="visible",i.focus()}return t.stopPropagation(),void t.preventDefault()}if(this._controls)for(let e=0;e<this._controls.length;e++){let i=this._controls[e];if(m.isInsideRect(t.pageX,t.pageY,i.getCoors()))return this.startCtrl={x:t.pageX,y:t.pageY,ctrl:i},this._hideTools(),t.stopPropagation(),void t.preventDefault()}return this.selection&&m.isInsideRect(t.pageX,t.pageY,this.selection)?(this.startMove={x:t.pageX,y:t.pageY,dx:this.selection.x-t.pageX,dy:this.selection.y-t.pageY},this._hideTools(),t.stopPropagation(),void t.preventDefault()):this.selection&&m.isInsideRect(t.pageX,t.pageY,this.selection)?void 0:(function(){if(p.showHint){p.showHint=!1;let t=document.querySelectorAll(".hint");if(t)for(let e=0;e<t.length;e++)t[e].style.display="none"}}(),this._hideControls(),this.start={x:t.pageX,y:t.pageY},t.stopPropagation(),t.preventDefault(),void this._hideTools())}}onMouseUp(t){if(this.start){let e=m.reCalcInRange(t.pageX,0,w.width),i=m.reCalcInRange(t.pageY,0,w.height);this._log("mouseup"),this._setSelection({x:Math.min(this.start.x,e),y:Math.min(this.start.y,i),width:Math.abs(this.start.x-e),height:Math.abs(this.start.y-i)}),this._showControls(),this.render(),this.start=null,this.prevSelection=null,t.stopPropagation(),t.preventDefault(),this._showTools()}else(this.startCtrl||this.startMove)&&(this.startCtrl=null,this.startMove=null,this.prevSelection=null,t.stopPropagation(),t.preventDefault(),this._showTools());this.isMouseDown&&(this.isMouseDown=!1,this.checkStyleBtn())}render_(t=!1){let e=window.innerWidth,i=window.innerHeight,n=this.selection,s=this.ctx;if(s.fillStyle="rgba(0, 0, 0, 0.3)",!n)return s.clearRect(0,0,e,i),void s.fillRect(0,0,e,i);if(this.prevSelection){let t=this.prevSelection,e=5;s.clearRect(t.x-e,t.y-e,t.width+2*e,t.height+2*e),s.fillRect(t.x-e,t.y-e,t.width+2*e,t.height+2*e)}if(n&&(s.clearRect(n.x,n.y,n.width,n.height),this.redraw(this.ctx),!t&&(s.beginPath(),s.rect(n.x,n.y,n.width,n.height),s.globalCompositeOperation="source-over",s.lineWidth="1",s.strokeStyle=c,s.stroke(),this._controls)))for(let o=0;o<this._controls.length;o++)this._controls[o].render(this.ctx);s.stroke()}render(t=!1){let e=window.innerWidth,i=window.innerHeight,n=this.selection,s=this.ctx;if(s.fillStyle="rgba(0, 0, 0, 0.3)",!n)return s.clearRect(0,0,e,i),void s.fillRect(0,0,e,i);if(this.prevSelection){let t=Math.min(this.prevSelection.x,n.x)-5,e=Math.max(this.prevSelection.x+this.prevSelection.width,n.x+n.width)+5,i=Math.max(this.prevSelection.y+this.prevSelection.height,n.y+n.height)+5,o=Math.min(this.prevSelection.y,n.y)-5,l=e-t,r=i-o,h=n.x+n.width,c=n.y+n.height;s.clearRect(t,o,l,r),s.fillRect(t,o,h-t,n.y-o),s.fillRect(h,o,e-h,c-o),s.fillRect(n.x,c,e-n.x,i-c),s.fillRect(t,n.y,n.x-t,i-n.y)}else n&&!this.prevSelection&&s.clearRect(n.x,n.y,n.width,n.height);if(this.redraw(this.ctx),!t&&(s.beginPath(),s.rect(n.x,n.y,n.width,n.height),s.globalCompositeOperation="source-over",s.lineWidth="1",s.strokeStyle=c,s.stroke(),this._controls))for(let o=0;o<this._controls.length;o++)this._controls[o].render(this.ctx)}prepareOutput(){this.render(!0)}}function S(t){false}function C(t){l.send("log","error",t)}function I(){return x}function k(t){S();let e=I().map((t=>{var e=document.createElement("div");e.className+=" hint",e.innerHTML="<div>Click và kéo chuột để chọn vùng chụp màn hình</div><div>Ấn ESC để thoát</div>",e.style.left=window.innerWidth/2-225+"px",e.style.top="0px",document.body.appendChild(e)}));return p.showHint=!0,e}function L(){if(p&&p.zcanvas){let t=p.zcanvas.getSelection();if(!t)return;let e=document.createElement("canvas"),i=document.querySelectorAll(".screenshot"),n=nt(),s=t.width,o=t.height,l=t.x,r=t.y;S(),e.width=s*n,e.height=o*n;let h=e.getContext("2d");for(let c=0;c<i.length;c++){let t=i[c],a=parseInt(t.style.left),d=parseInt(t.style.top);if((a>=l&&a<=l+s||a+t.width>=l&&a+t.width<=l+s||a<l&&a+t.width>l+s)&&(d>=r&&d<=r+o||d+t.height>=r&&d+t.height<=r+o||d<r&&d+t.height>r+o)){let i=l>a?l-a:0,c=r>d?r-d:0,u=l>a?0:a-l,y=r>d?0:d-r;S((t.width,t.height)),i+s>t.width&&(s=t.width-i),c+o>t.height&&(o=t.height-c),e.width=s*n,e.height=o*n,S((t.width,t.height)),h.drawImage(t,i*n,c*n,s*n,o*n,u*n,y*n,s*n,o*n),p.zcanvas.redraw(h,i*n,c*n,n)}}return{data:e.toDataURL("image/jpeg",1),width:s,height:o,type:"image/jpeg"}}return null}function M(){let t=L();if(t){return o.nativeImage.createFromDataURL(t.data)}}function P(){rt(),l.send("screen-capture-close")}function T(){l.send("screen-capture-get-save-path")}function _(){let t=L();rt(),l.send("screen-capture-done",t,y)}function E(){S();let t=M();o.clipboard.writeImage(t),P()}function R(){if(p&&p.saveOpts)return p.saveOpts;let t=document.getElementById("saveTools");if(!t){let e=document.createElement("div");e.id="saveTools",e.innerHTML=['<div class="btn" id="closeBtn"><i class="icon-capture-cancel"></i></div>','<div class="btn" id="saveBtn"><i class="icon-capture-save"></i></div>','<div class="btn" id="copyBtn"><i class="icon-capture-copy"></i></div>','<div class="btn" id="doneBtn"><i class="icon-check"></i> Xong</div>'].join(""),e.style.visibility="hidden",e.querySelector("#closeBtn").addEventListener("click",P),e.querySelector("#saveBtn").addEventListener("click",T),e.querySelector("#doneBtn").addEventListener("click",_),e.querySelector("#copyBtn").addEventListener("click",E),document.body.appendChild(e),t=e,p.saveOpts=t}return t}function D(){let t=document.getElementById("editTools");if(!t){let e=document.createElement("div");e.id="editTools",e.innerHTML=['<div class="btn edit-btn" id="textBtn"><i class="icon-capture-text"></i></div>','<div class="btn edit-btn" id="doodleBtn"><i class="icon-capture-doodle"></i></div>','<div class="btn edit-btn disableBtn" id="undoBtn"><i class="icon-capture-undo"></i></div>','<div class="btn edit-btn " id="redoBtn"><i class="icon-capture-redo"></i></div>'].join(""),e.querySelector("#textBtn").addEventListener("click",F),e.querySelector("#doodleBtn").addEventListener("click",X),e.querySelector("#undoBtn").addEventListener("click",A),e.querySelector("#redoBtn").addEventListener("click",J),e.addEventListener("mousedown",(function(t){t.preventDefault(),t.stopPropagation()})),e.addEventListener("click",(function(t){t.preventDefault(),t.stopPropagation()})),document.body.appendChild(e),t=e,f=""}return t}function z(){let t=document.getElementById("inputBox");if(!t){let e=document.createElement("div");e.contentEditable="true",e.id="inputBox",e.style.position="absolute",e.style.background="transparent",e.style.font="serif",e.style.fontSize="25px",e.style.border="none",e.style.zIndex="101",e.style.outline="none",e.style.color="red",e.style.minWidth="10px",e.style.minHeight="10px",e.addEventListener("keyup",O),e.addEventListener("keypress",H),document.body.appendChild(e),t=e}return t}function O(t){13==t.keyCode&&(t.preventDefault(),t.stopPropagation())}function H(t){}function X(t){f!==a&&f!==d&&(f=g);let e=q(),i=D(),n=i.offsetLeft,s=i.offsetTop,o=n+i.clientWidth+1,l=s+37;e.style.visibility="visible",e.style.left=o+"px",e.style.top=l+"px",j(document.getElementById("doodleBtn")),t.preventDefault(),t.stopPropagation()}function j(t){let e=document.getElementsByClassName("selected");if(e&&e.length>0)for(let i=0;i<e.length;i++)e[i].className=e[i].className.replace("selected","");t&&(t.className+=" selected")}function Y(t){f=a,g=a,document.getElementById("doodleBtn").innerHTML='<i class="icon-capture-doodle"></i></i>',U(),t.preventDefault(),t.stopPropagation()}function W(t){f=d,g=d,document.getElementById("doodleBtn").innerHTML='<i class="icon-capture-paint"></i>',U(),t.preventDefault(),t.stopPropagation()}function q(){let t=document.getElementById("drawWithPencilTool");if(!t){let e=document.createElement("div");e.id="drawWithPencilTool",e.innerHTML=['<div class="btn" id="pencilBtn"><i class="icon-capture-doodle"></i></div>','<div class="btn" id="highlightBtn"><i class="icon-capture-paint"></i></div>'].join(""),e.querySelector("#pencilBtn").addEventListener("click",Y),e.querySelector("#highlightBtn").addEventListener("click",W),document.body.appendChild(e),t=e}return t}function N(t){if(U(),f===u){let e=z();!e.contains(t.target)&&e.innerText&&(p.zcanvas.onSubmitText(t),t.preventDefault())}}function U(){if("drawWithPencilTool"!==window.event.srcElement.id){q().style.visibility="hidden"}}function A(t){p.zcanvas.undo(),t.preventDefault(),t.stopPropagation()}function J(t){p.zcanvas.redo(),t.preventDefault(),t.stopPropagation()}function F(){f=u;let t=document.getElementById("textBtn");t&&j(t)}function G(t){switch(t.keyCode){case 27:P();break;case 13:_()}}function K(t,e,i,n=0,s=0,o){if(S(),t&&p){Date.now();t.toBlob((t=>{let l=URL.createObjectURL(t),r=new Image;r.width=e,r.height=i,r.onload=()=>{URL.revokeObjectURL(l);let t=n,e=s;r.style.top=e+"px",r.style.left=t+"px",r.className="screenshot",document.body.appendChild(r),S(Date.now())},r.onerror=t=>{C(t),URL.revokeObjectURL(l)},r.src=l,r.id="sc_"+o}),"image/jpeg",1)}}function Q(t){p.zcanvas.onMouseUp(t)}function V(t){p.zcanvas.onMouseDown(t)}function Z(t){p.zcanvas.onMouseMove(t)}function $(t){let e=document.createElement("canvas");e.width=t.width,e.height=t.height,e.id="screenCap",document.body.appendChild(e),document.addEventListener("click",N),window.addEventListener("mousedown",V),window.addEventListener("mouseup",Q),window.addEventListener("mousemove",Z),window.addEventListener("blur",lt),window.addEventListener("focus",ot),p={canvas:e,zcanvas:new B(e),bounds:t}}function tt(){S(),p.zcanvas&&p.zcanvas.render()}function et(t){let e=document.createElement("canvas"),i=e.getContext("2d"),n=new Uint8ClampedArray(t.frame),s=new ImageData(n,t.width,t.height);return e.width=t.width,e.height=t.height,i.putImageData(s,0,0),e}function it(t,e,i,n,s){let o=nt(),l=n/(e/o),r=s/(i/o);if(1==l&&1==r)return t;let h=document.createElement("canvas"),c=h.getContext("2d");return h.width=n,h.height=s,c.scale(l,r),c.drawImage(t,0,0),h}function nt(){return 1}function st(t,e=null,i=!1){if(S(),S(),v)return void S();v=!0,window.document.addEventListener("keyup",G),1==I().length?function(t){s.capture((e=>{let i=et(e);i=it(i,e.width,e.height,t.width,t.height),K(i,t.width,t.height)}),!0),$(t),setTimeout((()=>{tt(),k()}),10)}(t):function(t,e,i){let n=I();const o=t=>{t.frame?requestAnimationFrame((()=>{let i=et(t);for(let s=0;s<n.length;s++){let o=n[s];if(o.id==e){i=it(i,t.width,t.height,o.size.width,o.size.height),K(i,o.size.width,o.size.height);break}}})):C(" fail to get screenshot!")};s.capture(o,i),setTimeout((()=>{tt(),k()}),10)}(0,e,i),$(t)}function ot(){l.send("focus",y)}function lt(){let t=L();l.send("lost-focus",y,t)}function rt(){try{window.document.removeEventListener("keyup",G),window.removeEventListener("blur",lt),window.removeEventListener("focus",ot),p&&p.fabricCvs&&p.fabricCvs.dispose(),p=null,function(){for(var t=document.body;t.firstChild;)t.removeChild(t.firstChild)}(),S(),v=!1}catch(t){C(t)}}window.onerror=t=>{C(t),P()},S(),l.on("get-save-path-response",((t,e)=>{if(S(),!e)return;let i=M();i&&h.writeFile(e,i.toJPEG(100),(t=>{t?C(t):S(),P()}))})).on("capture-start",((t,e,i,n,s,o)=>{S(),x=n,w={width:i.width,height:i.height,x:0,y:0},y=s,e?setTimeout((()=>{st(i,s,o)}),150):st(i,s,o)})).on("capture-stop",(t=>{rt()})),r.setVisualZoomLevelLimits(1,1)},1:function(t,e,i){t.exports=i("/ey5")},"1rQ5":function(t,e,i){},NLsH:function(t,e){t.exports=require("electron")},"mw/K":function(t,e){t.exports=require("fs")}});
//# sourceMappingURL=sourcemaps/screenshot.1c41c23311c8b15682aa.js.map